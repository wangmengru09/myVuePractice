复制代码

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>WEB打印控件LODOP</title>
  <script language="javascript" src="E:\software\Lodop\LodopFuncs.js"></script>
</head>

<body>
  <object id="LODOP1" classid="clsid:2105C259-1E0C-4534-8141-A753534CB4CA" width=710 height=307>
    <param name="Caption" value="内嵌显示区域">
    <param name="Border" value="1">
    <param name="Color" value="#C0C0C0">
    <embed id="LODOP_EM1" TYPE="application/x-print-lodop" width=710 height=307 PLUGINSPAGE="install_lodop.exe">
  </object> <br>
  <a href="javascript:prn1_preview()">打印设计不内嵌</a><br>
  <a href="javascript:prn2_preview()">打印设计</a><br>
  <a href="javascript:prn3_preview()">打印预览</a><br>
  <script language="javascript" type="text/javascript">
    var LODOP; //声明为全局变量 
    function prn1_preview() { //不内嵌，无效
      LODOP = getLodop();
      LODOP.PRINT_INIT("");
      LODOP.ADD_PRINT_BARCODE(28, 34, 307, 47, "128A", "123456789012");
      LODOP.ADD_PRINT_TEXT(91, 69, 100, 25, "第二个打印项");
      LODOP.PRINT_DESIGN(); //打印设计    
      LODOP.SET_PRINT_STYLEA(2, 'Deleted', true); //删除第二个打印项，无效   
    };

    function prn2_preview() { //内嵌的时候打印设计可以删除
      LODOP = getLodop(document.getElementById('LODOP1'), document.getElementById('LODOP_EM1'));
      LODOP.PRINT_INIT("");
      LODOP.ADD_PRINT_BARCODE(28, 34, 307, 47, "128A", "123456789012");
      LODOP.ADD_PRINT_TEXT(91, 69, 100, 25, "第二个打印项");
      LODOP.SET_SHOW_MODE("DESIGN_IN_BROWSE", 1); //打印设计界面内嵌
      LODOP.PRINT_DESIGN(); //打印设计    
      LODOP.SET_PRINT_STYLEA(2, 'Deleted', true); //删除第二个打印项，有效
    };

    function prn3_preview() { //内嵌的时候打印预览不能删除
      LODOP = getLodop(document.getElementById('LODOP1'), document.getElementById('LODOP_EM1'));
      LODOP.PRINT_INIT("");
      LODOP.ADD_PRINT_BARCODE(28, 34, 307, 47, "128A", "123456789012");
      LODOP.ADD_PRINT_TEXT(91, 69, 100, 25, "第二个打印项");
      LODOP.SET_SHOW_MODE("PREVIEW_IN_BROWSE", true); //打印预览界面内嵌
      LODOP.PREVIEW(); //打印预览
      LODOP.SET_PRINT_STYLEA(2, 'Deleted', true); //删除第二个打印项，无效
    };
    let list = [{
      label: '对象信息',
      children: [{
        label: '基本信息',
        params: 'patientInfo',
        children: [{
            label: '姓名',
            params: 'patientInfo.name'
          },
          {
            label: '性别',
            params: 'patientInfo.sex'
          },
          {
            label: '地址',
            params: 'patientInfo.address'
          }
        ]
      }]
    }]

    console.log(JSON.stringify(list))

  </script>
</body
